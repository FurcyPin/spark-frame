
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://furcypin.github.io/spark-frame/">
      
      
      
        <link rel="next" href="use_cases/intro/">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.5">
    
    
      
        <title>Spark-frame</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="css/mkdocstrings.css">
    
      <link rel="stylesheet" href="css/custom_width.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#spark-frame" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Spark-frame" class="md-header__button md-logo" aria-label="Spark-frame" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Spark-frame
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              What is spark-frame ?
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/FurcyPin/spark-frame" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    FurcyPin/spark-frame
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Spark-frame" class="md-nav__button md-logo" aria-label="Spark-frame" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Spark-frame
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/FurcyPin/spark-frame" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    FurcyPin/spark-frame
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    What is spark-frame ?
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    What is spark-frame ?
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-it" class="md-nav__link">
    <span class="md-ellipsis">
      What is it ?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    <span class="md-ellipsis">
      Getting Started
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compatibilities-and-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Compatibilities and requirements
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Use cases
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Use cases
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="use_cases/intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="use_cases/comparing_dataframes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Comparing DataFrames
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="use_cases/working_with_nested_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Working with nested data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="use_cases/working_with_json/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Working with json
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="use_cases/flatten_unflatten/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using flatten/unflatten
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="reference/data_diff/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    spark_frame.data_diff
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="reference/filesystem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    spark_frame.filesystem
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="reference/functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    spark_frame.functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="reference/graph/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    spark_frame.graph
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="reference/nested/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    spark_frame.nested
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="reference/nested_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    spark_frame.nested_functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="reference/schema_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    spark_frame.schema_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="reference/transformations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    spark_frame.transformations
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-it" class="md-nav__link">
    <span class="md-ellipsis">
      What is it ?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    <span class="md-ellipsis">
      Getting Started
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compatibilities-and-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Compatibilities and requirements
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<!-- BEGIN INCLUDE ../README.md -->
<h1 id="spark-frame">Spark-frame</h1>
<p><a href="https://badge.fury.io/py/spark-frame"><img alt="PyPI version" src="https://badge.fury.io/py/spark-frame.svg" /></a>
<a href="https://pypi.org/project/spark-frame/"><img alt="PyPI - Python Version" src="https://img.shields.io/pypi/pyversions/spark-frame.svg" /></a>
<a href="https://github.com/FurcyPin/spark-frame/actions"><img alt="GitHub Build" src="https://img.shields.io/github/actions/workflow/status/FurcyPin/spark-frame/build_and_validate.yml?branch=main" /></a>
<a href="https://sonarcloud.io/component_measures?id=FurcyPin_spark-frame&amp;metric=coverage&amp;view=list"><img alt="SonarCloud Coverage" src="https://sonarcloud.io/api/project_badges/measure?project=FurcyPin_spark-frame&amp;metric=coverage" /></a>
<a href="https://sonarcloud.io/component_measures?metric=reliability_rating&amp;view=list&amp;id=FurcyPin_spark-frame"><img alt="SonarCloud Bugs" src="https://sonarcloud.io/api/project_badges/measure?project=FurcyPin_spark-frame&amp;metric=bugs" /></a>
<a href="https://sonarcloud.io/component_measures?metric=security_rating&amp;view=list&amp;id=FurcyPin_spark-frame"><img alt="SonarCloud Vulnerabilities" src="https://sonarcloud.io/api/project_badges/measure?project=FurcyPin_spark-frame&amp;metric=vulnerabilities" /></a>
<a href="https://pypi.org/project/spark-frame/"><img alt="PyPI - Downloads" src="https://img.shields.io/pypi/dm/spark-frame" /></a>
<a href="https://github.com/psf/black"><img alt="Code style: black" src="https://img.shields.io/badge/code%20style-black-000000.svg" /></a></p>
<h2 id="what-is-it">What is it ?</h2>
<p><strong><a href="https://furcypin.github.io/spark-frame/">Spark-frame</a> is a library that super-charges your Spark DataFrames!</strong></p>
<p>It brings several utility methods and transformation functions for PySpark DataFrames.</p>
<p>Here is a quick list of the most exciting features <img alt="ðŸ˜Ž" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f60e.svg" title=":sunglasses:" /></p>
<ul>
<li><code>spark_frame.data_diff.compare_dataframes</code>: compare two SQL tables or DataFrames and generate an HTML report 
  to view the result. And yes, this is completely free, open source, and it works even with 
  complex data structures ! It also detects column reordering and can handle type changes.
  <a href="https://furcypin.github.io/spark-frame/use_cases/comparing_dataframes/">Go check it out <img alt="â—" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2757.svg" title=":exclamation:" /></a></li>
<li><code>spark_frame.nested</code>: Did you ever thought manipulating complex data structures in SQL or Spark was a 
  nightmare <img alt="ðŸŽƒ" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f383.svg" title=":jack_o_lantern:" /> ? You just found the solution ! The <code>nested</code> library  makes those manipulations much 
  cleaner and simpler. 
  <a href="https://furcypin.github.io/spark-frame/use_cases/working_with_nested_data/">Get started over there <img alt="ðŸš€" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f680.svg" title=":rocket:" /></a></li>
<li><code>spark_frame.transformations</code>: A wide collection of generic dataframe transformations.<ul>
<li>Ever wanted to apply a transformation to every field of a DataFrame depending on it's name or type ? 
  <a href="https://furcypin.github.io/spark-frame/reference/transformations/#spark_frame.transformations_impl.transform_all_fields.transform_all_fields">Easy as pie <img alt="ðŸ°" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f370.svg" title=":cake:" /></a></li>
<li>Ever wanted to rename every field of a DataFrame, including the deeply nested ones ? 
  <a href="https://furcypin.github.io/spark-frame/reference/transformations/#spark_frame.transformations_impl.transform_all_field_names.transform_all_field_names">Done: <img alt="ðŸ‘Œ" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f44c.svg" title=":ok_hand:" /></a></li>
<li>Ever wanted to analyze the content of a DataFrame, 
  but <a href="https://spark.apache.org/docs/3.1.1/api/python/reference/api/pyspark.sql.DataFrame.describe.html"><code>DataFrame.describe()</code></a>
  does not work with complex data types ? 
  <a href="https://furcypin.github.io/spark-frame/reference/transformations/#spark_frame.transformations_impl.analyze.analyze">You're welcome <img alt="ðŸ™" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f64f.svg" title=":pray:" /></a></li>
</ul>
</li>
<li><code>spark_frame.schema_utils</code>: Need to dump the schema of a DataFrame somewhere to be able to load it later ?
     <a href="https://furcypin.github.io/spark-frame/reference/schema_utils/">We got you covered <img alt="ðŸ‘" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f44d.svg" title=":thumbsup:" /></a></li>
<li><code>spark_frame.graph.ascending_forest_traversal</code>: Need an algorithm that takes the adjacency matrix of a 
 tree <img alt="ðŸŒ³" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f333.svg" title=":deciduous_tree:" /> (or forest) graph and associates each node to their corresponding root node ?
 But that other algorithm you tried went into an infinite loop âˆž because your graph isn't really a tree 
 and occasionally contains cycles ? 
 <a href="https://furcypin.github.io/spark-frame/reference/graph/#spark_frame.graph_impl.ascending_forest_traversal.ascending_forest_traversal">Try this <img alt="ðŸŒ²" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f332.svg" title=":evergreen_tree:" /></a></li>
</ul>
<h2 id="getting-started">Getting Started</h2>
<p>Visit the official Spark-frame website <a href="https://furcypin.github.io/spark-frame/">documentation</a> 
for <a href="https://furcypin.github.io/spark-frame/use_cases/intro/">use cases examples</a> 
and <a href="https://furcypin.github.io/spark-frame/reference/functions/">reference</a>.</p>
<h2 id="installation">Installation</h2>
<p><a href="https://pypi.org/project/spark-frame/">spark-frame is available on PyPi</a>.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>pip<span class="w"> </span>install<span class="w"> </span>spark-frame
</span></code></pre></div>
<h2 id="compatibilities-and-requirements">Compatibilities and requirements</h2>
<p>This library does not depend on any other library.
<strong>Pyspark must be installed separately to use it.</strong>
It is compatible with the following versions:</p>
<ul>
<li>Python: requires 3.8.1 or higher (tested against Python 3.9, 3.10 and 3.11)</li>
<li>Pyspark: requires 3.3.0 or higher</li>
</ul>
<p>This library is tested against Windows, Mac and Linux.</p>
<p><strong>Some features require extra libraries to be installed alongside this project.</strong>
<strong>We chose to not include them as direct dependencies for security and flexibility reasons.</strong>
<strong>This way, users who are not using these features don't need to worry about these dependencies.</strong></p>
<table>
<thead>
<tr>
<th>feature</th>
<th>Method</th>
<th>spark-frame's <br> version</th>
<th style="text-align: right;">dependency required</th>
</tr>
</thead>
<tbody>
<tr>
<td>Generating HTML <br> reports for data diff</td>
<td><code>DiffResult.export_to_html</code></td>
<td>&gt;= 0.4.0</td>
<td style="text-align: right;">data-diff-viewer==0.2.*</td>
</tr>
<tr>
<td>Generating HTML <br> reports for data diff</td>
<td><code>DiffResult.export_to_html</code></td>
<td>&lt; 0.4</td>
<td style="text-align: right;">jinja2</td>
</tr>
</tbody>
</table>
<p><em>Since version 0.4, the code used to generate HTML diff reports has been moved to 
<a href="https://github.com/FurcyPin/data-diff-viewer">data-diff-viewer</a> from the same author. 
It comes with a dependency to <a href="https://github.com/duckdb/duckdb">duckdb</a>, 
which is used to store the diff results and embed them in the HTML page.</em></p>
<h1 id="genesis-of-the-project">Genesis of the project</h1>
<p>These methods were initially part of the <a href="https://github.com/FurcyPin/karadoc">karadoc</a> project 
used at <a href="https://medium.com/younited-tech-blog">Younited</a>, but they were fully independent from karadoc, 
so it made more sense to keep them as a standalone library.</p>
<p>Several of these methods were my initial inspiration to make the cousin project
<a href="https://github.com/FurcyPin/bigquery-frame">bigquery-frame</a>, which was first made to illustrate
this <a href="https://medium.com/towards-data-science/sql-jinja-is-not-enough-why-we-need-dataframes-4d71a191936d">blog article</a>.
This is why you will find similar methods in both <code>spark_frame</code> and <code>bigquery_frame</code>, 
except the former runs on PySpark while the latter runs on BigQuery (obviously).
I try to keep both projects consistent together, and will eventually port new developments made on 
one project to the other one.</p>
<h1 id="changelog">Changelog</h1>
<h1 id="v040">v0.4.0</h1>
<p>Fixes and improvements on data_diff.</p>
<p>Improvements:
- data-diff: 
  - Now supports complex data types. Declaring a repeated field (e.g. <code>"s!.id"</code> in join_cols will now explode the
    corresponding array and perform the diff on it).
  - When columns are removed or renamed, they are now still displayed in the per-column diff report.
  - Refactored and improved the HTML report: it is now fully standalone and can be opened without any 
    internet connection .
  - Can now generate the HTML report directly on any remote file system accessible by Spark (e.g. "hdfs", "s3", etc.)
  - A user-friendly error is now raised when one of the <code>join_cols</code> does not exist. 
- added package <code>spark_frame.filesystem</code> that can be used to read and write files directly from the driver using
  the java FileSystem from Spark's JVM.</p>
<p><strong>Breaking Changes:</strong>
- data-diff:
  - <code>spark_frame.data_diff.DataframeComparator</code> object has been removed. 
    Please use directly the method <code>spark_frame.data_diff.compare_dataframes</code>.
  - package <code>spark_frame.data_diff.diff_results</code> has been renamed to <code>diff_results</code>.
  - Generating HTML reports for data diff does not require jinja anymore, but it does now require the installation 
    of the library <a href="https://pypi.org/project/data-diff-viewer/">data-diff-viewer</a>, 
    please check the <a href="..#compatibilities-and-requirements">Compatibilities and requirements</a> 
    section to know which version to use.
  - The DiffResult object returned by the <code>compare_dataframes</code> method has evolved. In particular, the
    type of <code>diff_df_shards</code> changed from a single <code>DataFrame</code> to a <code>Dict[str, DataFrame]</code>.
  - <code>DiffFormatOptions.max_string_length</code> option has been removed
  - <code>DiffFormatOptions.nb_diffed_rows</code> has been renamed to <code>nb_top_values_kept_per_column</code>
  - <code>spark_frame.data_diff.compare_dataframes_impl.DataframeComparatorException</code> was replaced with
    <code>spark_frame.exceptions.DataFrameComparisonException</code>
  - <code>spark_frame.data_diff.compare_dataframes_impl.CombinatorialExplosionError</code> was replaced with
    <code>spark_frame.exceptions.CombinatorialExplosionError</code></p>
<p>QA:
- Spark: Added tests to ensure compatibility with Pyspark versions 3.3, 3.4 and 3.5
- Replaced flake and isort with ruff</p>
<h1 id="v032">v0.3.2</h1>
<p>Fixes and improvements on data_diff</p>
<ul>
<li>Fix: automatic detection of join_col was sometimes selecting the wrong column</li>
<li>Visual improvements to HTML diff report:</li>
<li>Name of columns used for join are now displayed in bold</li>
<li>Total number of column is now displayed when the diff is ok</li>
<li>Fix incorrect HTML diff display when one of the DataFrames is empty</li>
</ul>
<h1 id="v031">v0.3.1</h1>
<p>Fixes and improvements on data_diff</p>
<ul>
<li>The <code>export_html_diff_report</code> method now accepts arguments to specify the path and encoding of the output html report. </li>
<li>Data-diff join now works correctly with null values</li>
<li>Visual improvements to HTML diff report</li>
</ul>
<h1 id="v030">v0.3.0</h1>
<p>Fixes and improvements on data_diff</p>
<ul>
<li>Fixed incorrect diff results</li>
<li>Column values are not truncated at all, this was causing incorrect results. The possibility to limit the size 
  of the column values will be added back in a later version</li>
<li>Made sure that the most frequent values per column are now displayed by decreasing order of frequency</li>
</ul>
<h1 id="v020">v0.2.0</h1>
<p>Two new exciting features: <em>analyze</em> and <em>data_diff</em>. 
They are still in experimental stage and will be improved in future releases.</p>
<ul>
<li>Added a new transformation <code>spark_frame.transformations.analyze</code>.</li>
<li>Added new <em>data_diff</em> feature. Example:</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">DataFrame</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="kn">from</span> <span class="nn">spark_frame.data_diff</span> <span class="kn">import</span> <span class="n">DataframeComparator</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="n">df1</span><span class="p">:</span> <span class="n">DataFrame</span> <span class="o">=</span> <span class="o">...</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="n">df2</span><span class="p">:</span> <span class="n">DataFrame</span> <span class="o">=</span> <span class="o">...</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="n">diff_result</span> <span class="o">=</span> <span class="n">DataframeComparator</span><span class="p">()</span><span class="o">.</span><span class="n">compare_df</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">)</span> <span class="c1"># Produces a DiffResult object</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="n">diff_result</span><span class="o">.</span><span class="n">display</span><span class="p">()</span> <span class="c1"># Print a diff report in the terminal</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="n">diff_result</span><span class="o">.</span><span class="n">export_to_html</span><span class="p">()</span> <span class="c1"># Generates a html diff report file named diff_report.html</span>
</span></code></pre></div>
<h1 id="v011">v0.1.1</h1>
<ul>
<li>Added a new transformation <code>spark_frame.transformations.flatten_all_arrays</code>.</li>
<li>Added support for multi-arg transformation to <code>nested.select</code> and <code>nested.with_fields</code> 
  With this feature, we can now access parent fields from higher levels
  when applying a transformation. Example:</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>&gt;&gt;&gt; nested.print_schema(df)
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>&quot;&quot;&quot;
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>root
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a> |-- id: integer (nullable = false)
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a> |-- s1!.average: integer (nullable = false)
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a> |-- s1!.values!: integer (nullable = false)
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>&quot;&quot;&quot;
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>&gt;&gt;&gt; df.show(truncate=False)
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>+---+--------------------------------------+
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>|id |s1                                    |
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>+---+--------------------------------------+
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>|1  |[{2, [1, 2, 3]}, {3, [1, 2, 3, 4, 5]}]|
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>+---+--------------------------------------+
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>&gt;&gt;&gt; new_df = df.transform(nested.with_fields, {
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>&gt;&gt;&gt;     &quot;s1!.values!&quot;: lambda s1, value: value - s1[&quot;average&quot;]  # This transformation takes 2 arguments
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>&gt;&gt;&gt; })
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>+---+-----------------------------------------+
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>|id |s1                                       |
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>+---+-----------------------------------------+
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>|1  |[{2, [-1, 0, 1]}, {3, [-2, -1, 0, 1, 2]}]|
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>+---+-----------------------------------------+
</span></code></pre></div>
<h1 id="v010">v0.1.0</h1>
<ul>
<li>
<p>Added a new <em>amazing</em> module called <code>spark_frame.nested</code>, 
  which makes manipulation of nested data structure much easier!
  Make sure to check out the <a href="https://furcypin.github.io/spark-frame/reference/nested/">reference</a>
  and the <a href="https://furcypin.github.io/spark-frame/use_cases/working_with_nested_data/">use-cases</a>.</p>
</li>
<li>
<p>Also added a new module called <code>spark_frame.nested_functions</code>,
  which contains aggregation methods for nested data structures
  (<a href="https://furcypin.github.io/spark-frame/reference/nested_functions/">See Reference</a>).</p>
</li>
<li>
<p>New <a href="https://furcypin.github.io/spark-frame/reference/transformations/">transformations</a>:</p>
</li>
<li><code>spark_frame.transformations.transform_all_field_names</code></li>
<li><code>spark_frame.transformations.transform_all_fields</code></li>
<li><code>spark_frame.transformations.unnest_field</code></li>
<li><code>spark_frame.transformations.unnest_all_fields</code></li>
<li><code>spark_frame.transformations.union_dataframes</code></li>
</ul>
<h1 id="v003">v0.0.3</h1>
<ul>
<li>New transformation: <code>spark_frame.transformations.convert_all_maps_to_arrays</code>.</li>
<li>New transformation: <code>spark_frame.transformations.sort_all_arrays</code>.</li>
<li>New transformation: <code>spark_frame.transformations.harmonize_dataframes</code>.</li>
</ul>
<!-- END INCLUDE -->












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["content.code.copy", "content.code.select"], "search": "assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.c18c5fb9.min.js"></script>
      
    
  </body>
</html>